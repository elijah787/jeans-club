<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeans Club - Raised on Denim</title>
    <style>
        /* MERCEDES-BENZ INSPIRED HEADER & NAVIGATION */
        .mercedes-header {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            color: white;
            font-family: 'Arial', sans-serif;
            position: relative;
            z-index: 1000;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 40px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .brand-logo {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #ffffff;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .logo-jeans {
            color: #00AFF0;
        }

        .logo-club {
            color: #ffffff;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .search-icon, .user-icon, .menu-toggle {
            cursor: pointer;
            font-size: 20px;
            transition: color 0.3s;
        }

        .search-icon:hover, .user-icon:hover, .menu-toggle:hover {
            color: #00AFF0;
        }

        /* Search Modal */
        .search-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: flex-start;
            padding-top: 100px;
        }

        .search-modal.active {
            display: flex;
        }

        .search-container {
            width: 90%;
            max-width: 600px;
        }

        .search-input {
            width: 100%;
            padding: 20px;
            font-size: 24px;
            background: transparent;
            border: none;
            border-bottom: 3px solid #00AFF0;
            color: white;
            outline: none;
        }

        .search-input::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .search-results {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
        }

        .search-result-item {
            padding: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            color: white;
            cursor: pointer;
            transition: background 0.3s;
        }

        .search-result-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .search-close {
            position: absolute;
            top: 30px;
            right: 30px;
            color: white;
            font-size: 30px;
            cursor: pointer;
            background: rgba(0,0,0,0.5);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Main Navigation */
        .main-navigation {
            display: flex;
            justify-content: center;
            padding: 0 40px;
            background: rgba(0, 0, 0, 0.95);
        }

        .nav-links {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
            gap: 40px;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            color: #ffffff;
            text-decoration: none;
            padding: 20px 0;
            display: inline-block;
            font-size: 15px;
            font-weight: 500;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            transition: color 0.3s;
        }

        .nav-link:hover {
            color: #00AFF0;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: #00AFF0;
            transition: width 0.3s;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        /* Mobile Menu Toggle */
        .menu-toggle {
            display: none;
            flex-direction: column;
            gap: 4px;
            cursor: pointer;
        }

        .menu-toggle span {
            width: 25px;
            height: 2px;
            background: white;
            transition: 0.3s;
        }

        /* Full Page Background */
        body {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)),
                        url('https://images.unsplash.com/photo-1542272604-787c3835535d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
        }

        /* Hero Section */
        .hero-section {
            color: white;
            padding: 100px 20px;
            text-align: center;
            margin-bottom: 60px;
            background: transparent;
        }

        .hero-title {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 20px;
            letter-spacing: 2px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .hero-subtitle {
            font-size: 20px;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto 40px;
            line-height: 1.6;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        /* Information Pages */
        .info-page {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 40px;
            margin: 20px auto;
            max-width: 1200px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .info-page h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-align: center;
        }

        .info-page h2 {
            color: #667eea;
            margin: 30px 0 15px;
            font-size: 1.8em;
        }

        .info-page p {
            color: #555;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .info-page ul, .info-page ol {
            color: #555;
            margin-left: 20px;
            margin-bottom: 20px;
        }

        .info-page li {
            margin-bottom: 10px;
        }

        .tiers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .tier-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-top: 4px solid;
        }

        .tier-card.pearl { border-color: #FFF8DC; }
        .tier-card.bronze { border-color: #B76E79; }
        .tier-card.silver { border-color: #2C3E50; }
        .tier-card.ruby { border-color: #8B475D; }
        .tier-card.gold { border-color: #FFD700; }
        .tier-card.sapphire { border-color: #34495E; }
        .tier-card.platinum { border-color: #2F4F4F; }

        .tier-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .benefits-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .benefit-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .benefit-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }

        /* Enhanced Voucher/QR Details Display */
        .voucher-details-display, .qr-details-display {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .detail-item {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .detail-item strong {
            color: #333;
            display: block;
            margin-bottom: 5px;
        }

        /* Social Media Links */
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }

        .social-link {
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.3s;
        }

        .social-link:hover {
            transform: translateY(-2px);
        }

        .social-tiktok { background: #000000; }
        .social-instagram { background: #E4405F; }
        .social-x { background: #000000; }

        /* REST OF YOUR EXISTING CSS STYLES */
        * {
            margin: 0;
            padding: 0;
            border: 0;
            font-size: 100%;
            font: inherit;
            vertical-align: baseline;
            box-sizing: inherit;
        }

        *, *::after, *::before {
            box-sizing: inherit;
        }

        html {
            width: 100%;
            height: auto;
            overflow-x: visible;
            overflow-x: initial;
            font-size: 10px;
            line-height: 1;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
            -ms-text-size-adjust: 100%;
            -webkit-text-size-adjust: 100%;
            --scrollWidth: 0px;
        }

        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            color: #333;
            font-size: 1.4rem;
            font-family: HelveticaNeue-Light, Helvetica, Arial, sans-serif;
            line-height: 1.1;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, .004);
        }

        /* TYPOGRAPHY SYSTEM */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            font-family: Emirates-Bold, Helvetica, Arial, Lucida Grande, sans-serif;
            display: inline-block;
            margin: 0 0 1rem;
            text-align: left;
        }

        h1 {
            font-size: 2.5em;
        }

        h2 {
            font-size: 1.6rem;
        }

        .reset-h {
            display: block;
        }

        .links-section__heading {
            margin: 0;
            padding: 10px;
            color: #fff;
            font-weight: 400;
            font-size: 1.8rem;
            line-height: 2.5rem;
            opacity: .9;
            -webkit-font-smoothing: antialiased;
        }

        @media only screen and (min-width: 1024px) {
            .links-section__heading {
                padding: 25px 0 0;
            }
        }

        /* YOUR EXISTING COMPONENT STYLES */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #333;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            color: #666;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .hidden {
            display: none;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        input, select, button, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: HelveticaNeue-Light, Helvetica, Arial, sans-serif;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            font-family: Emirates-Bold, Helvetica, Arial, sans-serif;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn.secondary {
            background: #6c757d;
        }

        .btn.google {
            background: white;
            color: #333;
            border: 2px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn.google img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }

        .section-title {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
            font-family: Emirates-Bold, Helvetica, Arial, sans-serif;
        }

        .member-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .info-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-family: Emirates-Bold, Helvetica, Arial, sans-serif;
        }

        .info-card p {
            color: #666;
            font-size: 1.1em;
        }

        .tier-pearl { color: #FFF8DC; }
        .tier-bronze { color: #B76E79; }
        .tier-silver { color: #2C3E50; }
        .tier-ruby { color: #8B475D; }
        .tier-gold { color: #FFD700; }
        .tier-sapphire { color: #34495E; }
        .tier-platinum { color: #2F4F4F; }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            transition: width 0.3s ease;
        }

        .activity-log {
            max-height: 300px;
            overflow-y: auto;
        }

        .activity-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .discount-result {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .discount-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .discount-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .admin-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #28a745;
        }

        .members-list {
            display: grid;
            gap: 15px;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .nav-buttons .btn {
            flex: 1;
        }

        .newsletter-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
        }

        .newsletter-checkbox input {
            width: auto;
        }

        .newsletter-checkbox label {
            margin: 0;
            font-weight: normal;
        }

        /* IMPROVED MEMBER CARD STYLES - FIXED FOR MOBILE */
        .member-card-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            perspective: 1000px;
        }

        .member-card {
            width: 360px;
            height: 220px;
            border-radius: 20px;
            padding: 25px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0,0,0,0.25);
            font-family: 'Arial', sans-serif;
            color: white;
            transition: transform 0.3s ease;
            transform-style: preserve-3d;
        }

        .member-card:hover {
            transform: translateY(-5px) rotateX(5deg);
        }

        /* UPDATED TIER COLORS */
        .member-card.pearl {
            background: linear-gradient(135deg, #FFF8DC 0%, #F5DEB3 100%);
            color: #333;
        }

        .member-card.bronze {
            background: linear-gradient(135deg, #B76E79 0%, #8B475D 100%);
        }

        .member-card.silver {
            background: linear-gradient(135deg, #2C3E50 0%, #34495E 100%);
        }

        .member-card.ruby {
            background: linear-gradient(135deg, #8B475D 0%, #6B3648 100%);
        }

        .member-card.gold {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: #333;
        }

        .member-card.sapphire {
            background: linear-gradient(135deg, #34495E 0%, #1F2B3A 100%);
        }

        .member-card.platinum {
            background: linear-gradient(135deg, #2F4F4F 0%, #000000 100%);
        }

        /* Card design elements */
        .card-background-pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.8) 2px, transparent 2px),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.6) 1px, transparent 1px);
            background-size: 30px 30px;
        }

        .card-logo {
            position: absolute;
            top: 20px;
            right: 25px;
            font-weight: bold;
            font-size: 18px;
            letter-spacing: 1px;
        }

        .card-chip {
            position: absolute;
            top: 20px;
            left: 25px;
            width: 40px;
            height: 30px;
            background: linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 100%);
            border-radius: 5px;
            border: 1px solid rgba(255,255,255,0.5);
        }

        .card-chip::after {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            width: 30px;
            height: 20px;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.05) 100%);
            border-radius: 3px;
        }

        /* FIXED JC ID DISPLAY FOR MOBILE */
        .card-number {
            position: absolute;
            top: 75px; /* Adjusted for better mobile spacing */
            left: 25px;
            font-size: 20px; /* Slightly larger for better readability */
            letter-spacing: 3px; /* Increased spacing */
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            width: calc(100% - 50px);
            white-space: nowrap;
            overflow: visible;
            text-overflow: clip;
            display: flex;
            justify-content: flex-start;
            gap: 5px;
        }

        /* FIXED CARD HOLDER POSITIONING */
        .card-holder {
            position: absolute;
            bottom: 70px; /* Positioned above JC ID with more space */
            left: 25px;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.8;
        }

        .card-holder-name {
            font-size: 18px; /* Slightly larger for mobile */
            font-weight: bold;
            margin-top: 8px; /* More space between label and name */
            text-transform: uppercase;
            letter-spacing: 1.5px;
            line-height: 1.2;
        }

        .card-tier {
            position: absolute;
            bottom: 25px;
            left: 25px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: bold;
        }

        .card-date {
            position: absolute;
            bottom: 25px;
            right: 25px;
            font-weight: bold;
            font-size: 14px;
            letter-spacing: 1px;
        }

        /* Special number styling like the reference images */
        .card-number span {
            display: inline-block;
            background: rgba(0,0,0,0.2);
            padding: 2px 8px;
            margin: 0 1px;
            border-radius: 4px;
            min-width: 22px;
            text-align: center;
        }

        /* SIM card holographic effect */
        .card-hologram {
            position: absolute;
            top: 20px;
            right: 80px;
            width: 50px;
            height: 30px;
            background: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 5px,
                    rgba(255,255,255,0.2) 5px,
                    rgba(255,255,255,0.2) 10px
                ),
                repeating-linear-gradient(
                    -45deg,
                    transparent,
                    transparent 5px,
                    rgba(255,255,255,0.1) 5px,
                    rgba(255,255,255,0.1) 10px
                );
            border-radius: 5px;
            transform: skewX(-10deg);
            box-shadow: 0 0 5px rgba(255,255,255,0.3);
        }

        /* NEW VOUCHER MANAGEMENT STYLES */
        .voucher-management-section {
            margin-top: 30px;
        }

        .voucher-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #28a745;
        }

        .voucher-item.used {
            border-left-color: #6c757d;
            opacity: 0.7;
        }

        .voucher-item.expired {
            border-left-color: #dc3545;
        }

        .voucher-code {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            background: #e9ecef;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
            margin: 5px 0;
        }

        .voucher-qr {
            margin: 10px 0;
            text-align: center;
        }

        .voucher-status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-used {
            background: #e2e3e5;
            color: #383d41;
        }

        .status-expired {
            background: #f8d7da;
            color: #721c24;
        }

        .scan-voucher-section {
            background: #e7f3ff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #2196F3;
        }

        /* QR Redemption Styles */
        .redemption-option {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .redemption-option:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .redemption-option.selected {
            border-color: #28a745;
            background: #e8f5e8;
        }

        .option-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .option-tier {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }

        .selected-option-details {
            background: #e7f3ff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .success-card {
            background: #d4edda;
            color: #155724;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #c3e6cb;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .info-message {
            background: #e7f3ff;
            color: #2196F3;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }

        /* QR Code Container */
        .qr-code-container {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .qr-share-section {
            display: block !important;
        }

        /* Redemption Item */
        .redemption-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .redemption-status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }

        .redemption-id {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            background: #e9ecef;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
            margin: 5px 0;
        }

        /* NEW CAMERA SCANNER STYLES - FIXED */
        .camera-scanner-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 3000;
            justify-content: center;
            align-items: center;
        }

        .camera-scanner-modal.active {
            display: flex;
        }

        .camera-container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .camera-viewport {
            width: 100%;
            height: 400px;
            background: #000;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #cameraVideo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scaleX(1);
            background: #000;
        }

        .camera-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .scan-frame {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 250px;
            height: 250px;
            border: 3px solid #00AFF0;
            border-radius: 15px;
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.5);
        }

        .scan-line {
            position: absolute;
            width: 100%;
            height: 3px;
            background: #00AFF0;
            animation: scan 2s ease-in-out infinite;
        }

        @keyframes scan {
            0% { top: 0; }
            50% { top: calc(100% - 3px); }
            100% { top: 0; }
        }

        .camera-controls {
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .camera-btn {
            background: #00AFF0;
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .camera-btn:hover {
            background: #0090d0;
            transform: scale(1.1);
        }

        .camera-btn.close-btn {
            background: #dc3545;
        }

        .camera-btn.close-btn:hover {
            background: #c82333;
        }

        .scan-status {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            text-align: center;
            color: white;
            font-size: 18px;
            font-weight: bold;
            z-index: 100;
        }

        .scan-success {
            color: #28a745;
            text-shadow: 0 0 10px rgba(40, 167, 69, 0.5);
        }

        .scan-error {
            color: #dc3545;
            text-shadow: 0 0 10px rgba(220, 53, 69, 0.5);
        }

        .scan-processing {
            color: #ffc107;
            text-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
        }

        /* Status border effects */
        body.scan-success {
            border: 10px solid #28a745;
            animation: borderPulse 2s ease-in-out;
        }

        body.scan-error {
            border: 10px solid #dc3545;
            animation: borderPulse 2s ease-in-out;
        }

        @keyframes borderPulse {
            0% { border-width: 10px; }
            50% { border-width: 15px; }
            100% { border-width: 10px; }
        }

        /* Quick Scan Button */
        .quick-scan-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: transform 0.3s;
            margin: 10px 0;
        }

        .quick-scan-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .quick-scan-btn i {
            font-size: 20px;
        }

        /* Scan Results Display */
        .scan-results {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            animation: slideIn 0.3s ease;
        }

        .scan-results.success {
            border-left: 5px solid #28a745;
        }

        .scan-results.error {
            border-left: 5px solid #dc3545;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive Styles */
        @media (max-width: 1024px) {
            .nav-links {
                gap: 20px;
            }
            
            .header-top {
                padding: 15px 20px;
            }
            
            .main-navigation {
                padding: 0 20px;
            }
        }

        @media (max-width: 768px) {
            .menu-toggle {
                display: flex;
            }
            
            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(0, 0, 0, 0.95);
                flex-direction: column;
                padding: 20px;
                gap: 10px;
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .nav-link {
                padding: 15px;
                width: 100%;
            }
            
            .container {
                padding: 10px;
            }
            
            .card {
                padding: 20px;
            }
            
            .member-info {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .nav-buttons {
                flex-direction: column;
            }
            
            /* MOBILE CARD ADJUSTMENTS */
            .member-card {
                width: 320px;
                height: 200px;
                padding: 20px;
            }
            
            .card-number {
                top: 70px;
                font-size: 18px;
                letter-spacing: 2px;
            }
            
            .card-number span {
                padding: 2px 6px;
                min-width: 18px;
            }
            
            .card-holder {
                bottom: 65px;
            }
            
            .card-holder-name {
                font-size: 16px;
                margin-top: 6px;
            }
            
            .card-tier, .card-date {
                bottom: 20px;
                font-size: 12px;
            }
            
            .card-logo {
                font-size: 16px;
                top: 15px;
                right: 20px;
            }
            
            .card-chip {
                top: 15px;
                left: 20px;
                width: 35px;
                height: 25px;
            }
            
            .hero-title {
                font-size: 36px;
            }
            
            .hero-subtitle {
                font-size: 18px;
            }
            
            .tiers-grid, .benefits-list {
                grid-template-columns: 1fr;
            }
            
            .camera-viewport {
                height: 300px;
            }
            
            .scan-frame {
                width: 200px;
                height: 200px;
            }
        }

        @media (max-width: 480px) {
            .member-card {
                width: 290px;
                height: 180px;
                padding: 15px;
            }
            
            .card-number {
                top: 65px;
                font-size: 16px;
                letter-spacing: 1.5px;
            }
            
            .card-number span {
                padding: 1px 4px;
                min-width: 16px;
            }
            
            .card-holder {
                bottom: 60px;
                font-size: 10px;
            }
            
            .card-holder-name {
                font-size: 14px;
                margin-top: 4px;
                letter-spacing: 1px;
            }
            
            .card-tier, .card-date {
                bottom: 15px;
                font-size: 10px;
            }
            
            .card-logo {
                font-size: 14px;
                top: 10px;
                right: 15px;
            }
            
            .card-chip {
                top: 10px;
                left: 15px;
                width: 30px;
                height: 20px;
            }
            
            .hero-title {
                font-size: 28px;
            }
            
            .hero-subtitle {
                font-size: 16px;
            }
            
            .camera-viewport {
                height: 250px;
            }
            
            .scan-frame {
                width: 180px;
                height: 180px;
            }
            
            .camera-btn {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
        }

        @media (max-width: 360px) {
            .member-card {
                width: 280px;
                height: 170px;
            }
            
            .card-number {
                font-size: 14px;
            }
            
            .card-holder-name {
                font-size: 13px;
            }
        }

        /* Footer */
        .footer {
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 60px 20px 30px;
            margin-top: 60px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }

        .footer-section h3 {
            color: #00AFF0;
            margin-bottom: 20px;
            font-size: 18px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .footer-section p {
            color: #999;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            margin-top: 30px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #666;
            font-size: 14px;
        }
    </style>
    <!-- Add Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <!-- Add QR Scanner Library - FIXED VERSION -->
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
</head>
<body>
    <!-- Search Modal -->
    <div class="search-modal" id="searchModal">
        <div class="search-container">
            <input type="text" class="search-input" id="searchInput" placeholder="Search for members, vouchers, redemptions...">
            <div class="search-results" id="searchResults"></div>
        </div>
        <div class="search-close" onclick="hideSearch()">√ó</div>
    </div>

    <!-- Camera Scanner Modal - UPDATED -->
    <div class="camera-scanner-modal" id="cameraScannerModal">
        <div class="camera-container">
            <div class="scan-status" id="scanStatus">
                Loading camera...
            </div>
            <div class="camera-viewport">
                <div id="qr-reader" style="width: 100%; height: 100%;"></div>
                <div id="qr-reader-results"></div>
            </div>
            <div class="camera-controls">
                <button class="camera-btn close-btn" onclick="closeCameraScanner()">
                    √ó
                </button>
                <button class="camera-btn" onclick="switchCamera()" id="switchCameraBtn">
                    ‚Üª
                </button>
                <button class="camera-btn" onclick="toggleFlash()" id="flashBtn">
                    ‚ö°
                </button>
            </div>
        </div>
    </div>

    <!-- Mercedes-Benz Inspired Header -->
    <header class="mercedes-header">
        <div class="header-top">
            <div class="brand-logo">
                <div class="logo">
                    <span class="logo-jeans">JEANS</span>
                    <span class="logo-club">CLUB</span>
                </div>
            </div>
            
            <div class="header-actions">
                <div class="search-icon" onclick="showSearch()">üîç</div>
                <div class="user-icon" onclick="toggleUserMenu()">üë§</div>
                <div class="menu-toggle" onclick="toggleMobileMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
        
        <nav class="main-navigation">
            <ul class="nav-links" id="navLinks">
                <li class="nav-item"><a href="#dashboard" class="nav-link" onclick="showDashboardSection()">Dashboard</a></li>
                <li class="nav-item"><a href="#membership" class="nav-link" onclick="showMembershipInfo()">Membership</a></li>
                <li class="nav-item"><a href="#benefits" class="nav-link" onclick="showBenefits()">Benefits</a></li>
                <li class="nav-item"><a href="#tiers" class="nav-link" onclick="showTiers()">Tiers</a></li>
                <li class="nav-item"><a href="#rewards" class="nav-link" onclick="showRewards()">Rewards</a></li>
                <li class="nav-item"><a href="#qr" class="nav-link" onclick="showQRRedemptionPanel()">QR Redemption</a></li>
                <li class="nav-item"><a href="#contact" class="nav-link" onclick="showContact()">Contact</a></li>
            </ul>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero-section">
        <h1 class="hero-title">Raised on Denim</h1>
        <p class="hero-subtitle">Experience premium denim with exclusive tiered privileges. Join our loyalty program and unlock amazing rewards with every purchase.</p>
    </section>

    <div class="container" id="main-content">
        <!-- Information Pages (truncated for brevity, keep your existing content) -->
        <!-- ... Your existing information pages content ... -->

        <!-- Signup Section -->
        <div id="signupSection" class="card">
            <h2 class="section-title">Create Account</h2>
            <div class="form-group">
                <label for="userName">Full Name</label>
                <input type="text" id="userName" placeholder="Enter your full name" autocomplete="off">
            </div>
            <div class="form-group">
                <label for="userEmail">Email Address</label>
                <input type="email" id="userEmail" placeholder="Enter your email" autocomplete="off">
            </div>
            <div class="form-group">
                <label for="userPassword">Password</label>
                <input type="password" id="userPassword" placeholder="Create a password" autocomplete="new-password">
            </div>
            <div class="form-group">
                <label for="referralCode">Referral Code (Optional)</label>
                <input type="text" id="referralCode" placeholder="Enter referral code if any" autocomplete="off">
            </div>
            
            <div class="newsletter-checkbox">
                <input type="checkbox" id="newsletterSignup" checked>
                <label for="newsletterSignup">Subscribe to our newsletter for exclusive deals and updates</label>
            </div>
            
            <button class="btn" onclick="signUpWithEmail()">Create Account</button>
            <div class="form-group" style="text-align: center; margin: 20px 0;">
                <div style="border-bottom: 1px solid #ddd; line-height: 0.1em; margin: 10px 0 20px;">
                    <span style="background: white; padding: 0 10px; color: #666;">OR</span>
                </div>
                <div class="google-signin-button"></div>
            </div>
            <div class="form-group" style="text-align: center;">
                <p>Already have an account? <a href="#" onclick="showLoginScreen()" style="color: #667eea; text-decoration: none;">Login here</a></p>
            </div>
        </div>

        <!-- Login Section -->
        <div id="loginSection" class="card hidden">
            <h2 class="section-title">Login to Your Account</h2>
            <div class="form-group">
                <label for="loginJCId">JC ID</label>
                <input type="text" id="loginJCId" placeholder="Enter your JC ID" autocomplete="off">
            </div>
            <div class="form-group">
                <label for="loginPassword">Password</label>
                <input type="password" id="loginPassword" placeholder="Enter your password" autocomplete="current-password">
            </div>
            <button class="btn" onclick="loginWithCredentials()">Login</button>
            
            <div class="form-group" style="text-align: center; margin: 20px 0;">
                <a href="#" onclick="showPasswordResetScreen()" style="color: #667eea; text-decoration: none;">Forgot Password?</a>
            </div>
            
            <div class="form-group" style="text-align: center; margin: 20px 0;">
                <div style="border-bottom: 1px solid #ddd; line-height: 0.1em; margin: 10px 0 20px;">
                    <span style="background: white; padding: 0 10px; color: #666;">OR</span>
                </div>
                <div class="google-login-button"></div>
            </div>
            <div class="form-group" style="text-align: center;">
                <p>Don't have an account? <a href="#" onclick="showSignupScreen()" style="color: #667eea; text-decoration: none;">Sign up here</a></p>
            </div>
            <div class="form-group" style="text-align: center; margin-top: 20px;">
                <button class="btn secondary" onclick="showAdminLogin()">Staff Login</button>
            </div>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboardSection" class="card hidden">
            <div class="nav-buttons">
                <button class="btn secondary" onclick="logout()">Logout</button>
                <button class="btn" onclick="refreshData()">Refresh Data</button>
                <button class="btn" onclick="showQRRedemptionPanel()">üéüÔ∏è QR Code Redemption</button>
            </div>
            
            <h2 class="section-title">Member Dashboard</h2>
            
            <!-- IMPROVED MEMBER CARD DISPLAY -->
            <div class="member-card-container">
                <div id="memberCard" class="member-card">
                    <div class="card-background-pattern"></div>
                    <div class="card-logo">JEANS CLUB</div>
                    <div class="card-chip"></div>
                    <div class="card-hologram"></div>
                    <div class="card-number" id="cardNumber">XXXX XXXX XXXX XXXX</div>
                    <div class="card-holder">
                        CARD HOLDER
                        <div class="card-holder-name" id="cardHolderName">-</div>
                    </div>
                    <div class="card-tier" id="cardTier">-</div>
                    <div class="card-date" id="cardDate">MM/YY</div>
                </div>
            </div>
            
            <div class="member-info">
                <div class="info-card">
                    <h3>JC ID</h3>
                    <p id="memberJcId">-</p>
                </div>
                <div class="info-card">
                    <h3>Name</h3>
                    <p id="memberName">-</p>
                </div>
                <div class="info-card">
                    <h3>Email</h3>
                    <p id="memberEmail">-</p>
                </div>
                <div class="info-card">
                    <h3>Login Method</h3>
                    <p id="memberLoginMethod">-</p>
                </div>
            </div>

            <div class="member-info">
                <div class="info-card">
                    <h3>Current Tier</h3>
                    <p id="memberTier">-</p>
                </div>
                <div class="info-card">
                    <h3>Points Balance</h3>
                    <p id="memberPoints">-</p>
                </div>
                <div class="info-card">
                    <h3>Total Spent</h3>
                    <p id="totalSpent">- UGX</p>
                </div>
                <div class="info-card">
                    <h3>Referral Code</h3>
                    <p id="memberReferralCode">-</p>
                </div>
            </div>

            <div class="info-card">
                <h3>Tier Progress</h3>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                </div>
                <p id="tierProgressText">Loading progress...</p>
            </div>

            <div class="info-card">
                <h3>Newsletter Preferences</h3>
                <p>Get exclusive deals, new arrivals, and style tips delivered to your inbox</p>
                <button class="btn" onclick="toggleNewsletter()" id="newsletterToggle">
                    Subscribe to Newsletter
                </button>
            </div>

            <div class="info-card">
                <h3>Referral Stats</h3>
                <p id="referralStats">Loading stats...</p>
                <button class="btn" onclick="shareReferral()" style="margin-top: 10px;">Share Referral Code</button>
            </div>

            <div class="info-card">
                <h3>Redeem Points for Discount</h3>
                <div class="form-group">
                    <label for="discountPoints">Points to Use (Min: 10)</label>
                    <input type="number" id="discountPoints" placeholder="Enter points to redeem" min="10">
                </div>
                <button class="btn" onclick="calculateDiscount()">Calculate Discount</button>
                <div id="discountResult" class="discount-result"></div>
                <button class="btn" onclick="redeemPoints()" style="margin-top: 10px;">Generate Discount Voucher</button>
            </div>

            <!-- VOUCHER MANAGEMENT SECTION -->
            <div class="info-card voucher-management-section">
                <h3>My Discount Vouchers</h3>
                <div id="vouchersList" class="activity-log">
                    <div class="activity-item">Loading vouchers...</div>
                </div>
            </div>

            <div class="info-card">
                <h3>Recent Activity</h3>
                <div id="activityLog" class="activity-log">
                    <div class="activity-item">Loading activity...</div>
                </div>
            </div>
        </div>

        <!-- Admin Section with Quick Scan Button -->
        <div id="adminSection" class="card hidden">
            <div class="nav-buttons">
                <button class="btn secondary" onclick="logout()">Logout</button>
                <button class="btn" onclick="showAdminPanel()">Refresh Members</button>
                <button class="btn secondary" onclick="showDeleteMemberSection()">Delete Member</button>
                <button class="btn" onclick="showVoucherManagementPanel()">Manage Vouchers</button>
                <button class="btn" onclick="showQRRedemptionManagementPanel()">QR Redemptions</button>
                <!-- NEW QUICK SCAN BUTTON -->
                <button class="quick-scan-btn" onclick="openCameraScanner()">
                    üì∑ Quick Scan QR
                </button>
            </div>

            <h2 class="section-title">Staff Admin Panel</h2>
            
            <div class="info-card">
                <h3>Add Purchase</h3>
                <div class="form-group">
                    <label for="purchaseJCId">Member JC ID</label>
                    <input type="text" id="purchaseJCId" placeholder="Enter JC ID">
                </div>
                <div class="form-group">
                    <label for="purchaseAmount">Amount (UGX)</label>
                    <input type="number" id="purchaseAmount" placeholder="Enter amount">
                </div>
                <div class="form-group">
                    <label for="purchaseDescription">Description</label>
                    <input type="text" id="purchaseDescription" placeholder="Purchase description">
                </div>
                <button class="btn" onclick="adminAddPurchase()">Add Purchase</button>
                <div id="purchaseResult" style="margin-top: 10px;"></div>
            </div>

            <!-- ENHANCED VOUCHER SCANNING SECTION -->
            <div class="scan-voucher-section">
                <h3>üì± Scan & Redeem Voucher/QR Code</h3>
                
                <!-- Quick Scan Option -->
                <div style="text-align: center; margin-bottom: 20px;">
                    <button class="quick-scan-btn" onclick="openCameraScanner()">
                        üì∑ Open Camera Scanner
                    </button>
                    <p style="color: #666; font-size: 14px; margin-top: 10px;">OR enter code manually below</p>
                </div>
                
                <div class="form-group">
                    <label for="voucherCodeInput">Voucher Code or QR Data</label>
                    <input type="text" id="voucherCodeInput" placeholder="Enter voucher code or QR code data">
                </div>
                <div class="form-group">
                    <label for="salespersonName">Your Name (Salesperson)</label>
                    <input type="text" id="salespersonName" placeholder="Enter your name" required>
                </div>
                <button class="btn" onclick="processScan()">Process Scan</button>
                <div id="scanDetails" class="voucher-details-display hidden" style="margin-top: 20px;">
                    <!-- Details will be shown here -->
                </div>
                <div id="voucherRedeemResult" style="margin-top: 10px;"></div>
                
                <!-- Scan Results Display -->
                <div id="scanResults" class="scan-results hidden"></div>
            </div>

            <div class="info-card">
                <h3>Send Newsletter</h3>
                <div class="form-group">
                    <label for="newsletterSubject">Subject</label>
                    <input type="text" id="newsletterSubject" placeholder="Enter newsletter subject">
                </div>
                <div class="form-group">
                    <label for="newsletterContent">Content</label>
                    <textarea id="newsletterContent" placeholder="Enter newsletter content" rows="6" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; font-family: inherit;"></textarea>
                </div>
                <button class="btn" onclick="sendNewsletter()">Send Newsletter to All Subscribers</button>
                <div id="newsletterResult" style="margin-top: 10px;"></div>
            </div>

            <div id="adminContent">
                <!-- Members list will be loaded here -->
            </div>
        </div>

        <!-- QR Code Section -->
        <div class="card qr-share-section" style="text-align: center; margin-top: 20px;">
            <h3 style="color: #333; margin-bottom: 20px;">Share Jeans Club</h3>
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://elijah787.github.io/jeans-club" 
                 alt="QR Code for Jeans Club"
                 style="border: 2px solid #ddd; border-radius: 10px; padding: 10px; display: block; margin: 0 auto;">
            <p style="color: #666; margin-top: 15px;">Scan to share with friends</p>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>Jeans Club</h3>
                <p>Premium denim loyalty program with tiered privileges and exclusive benefits for our valued members.</p>
                <p>Raised on Denim, Elevated by Experience.</p>
                <div class="social-links">
                    <a href="https://www.tiktok.com/@jeansclubug?_r=1&_t=ZM-91wJ0p98EMG" target="_blank" class="social-link social-tiktok">
                        <span>üéµ</span> TikTok
                    </a>
                    <a href="https://www.instagram.com/jeans_club_ug?igsh=NmFkNTI5MDYzMTZk" target="_blank" class="social-link social-instagram">
                        <span>üì∏</span> Instagram
                    </a>
                    <a href="https://x.com/jeansclub_ug?s=20" target="_blank" class="social-link social-x">
                        <span>ùïè</span> X
                    </a>
                </div>
            </div>
            
            <div class="footer-section">
                <h3>Quick Links</h3>
                <p><a href="#" onclick="showSignupScreen()" style="color: #999; text-decoration: none;">Sign Up</a></p>
                <p><a href="#" onclick="showLoginScreen()" style="color: #999; text-decoration: none;">Login</a></p>
                <p><a href="#" onclick="showBenefits()" style="color: #999; text-decoration: none;">Benefits</a></p>
                <p><a href="#" onclick="showTiers()" style="color: #999; text-decoration: none;">Tiers</a></p>
            </div>
            
            <div class="footer-section">
                <h3>Contact</h3>
                <p>Email: oliviakamukama@gmail.com</p>
                <p>Phone: +256 772558913</p>
                <p>Hours: Mon-Saturday 8AM-9PM</p>
                <p>üìç Kampala, Uganda</p>
            </div>
            
            <div class="footer-section">
                <h3>Support</h3>
                <p>For membership inquiries and support:</p>
                <p>support@jeansclub.com</p>
                <p>Visit our website for more information</p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2026 Jeans Club. All rights reserved. | Premium Denim Loyalty Program</p>
        </div>
    </footer>

    <script>
        // ===========================
        // CAMERA SCANNER FUNCTIONALITY - COMPLETELY FIXED VERSION
        // ===========================
        
        let html5QrCode = null;
        let cameraId = null;
        let isScanning = false;

        // Open camera scanner
        function openCameraScanner() {
            if (!clubManager.isAdmin) {
                showToast("Please login as staff first", "error");
                return;
            }

            const modal = document.getElementById('cameraScannerModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            startCamera();
        }
         async function signUpWithEmail() {
    const name = document.getElementById('userName').value.trim();
    const email = document.getElementById('userEmail').value.trim();
    const password = document.getElementById('userPassword').value;
    const referralCode = document.getElementById('referralCode').value.trim();
    const newsletter = document.getElementById('newsletterSignup').checked;

    if (!name || !email || !password) {
        showToast("Please fill in all required fields", "error");
        return;
    }

    if (!isValidEmail(email)) {
        showToast("Please enter a valid email address (e.g., name@domain.com)", "error");
        return;
    }

    if (password.length < 6) {
        showToast("Password must be at least 6 characters", "error");
        return;
    }

    showToast("Creating account...", "info");

    try {
        const result = await clubManager.createAccount(
            { name, email, newsletter },
            password,
            referralCode
        );

        if (result.success) {
            showDashboard(result.member);
            showToast("Account created successfully! Welcome to Jeans Club! üéâ", "success");
            
            // Clear form fields
            document.getElementById('userName').value = '';
            document.getElementById('userEmail').value = '';
            document.getElementById('userPassword').value = '';
            document.getElementById('referralCode').value = '';
            
        } else {
            showToast(result.message, "error");
        }
    } catch (error) {
        console.error('Signup error:', error);
        showToast("An error occurred. Please try again.", "error");
    }
}

// Also add the email validation function if missing:
function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}
        // Start camera with simplified HTML5 QR Code library
        async function startCamera() {
            try {
                console.log("Starting camera scanner...");
                
                const scanStatus = document.getElementById('scanStatus');
                scanStatus.textContent = "Starting camera...";
                scanStatus.className = 'scan-status scan-processing';
                
                // Create QR reader container
                const qrReaderDiv = document.getElementById('qr-reader');
                qrReaderDiv.innerHTML = '';
                
                // Initialize the scanner
                html5QrCode = new Html5Qrcode("qr-reader");
                
                const config = {
                    fps: 10,
                    qrbox: { width: 250, height: 250 },
                    aspectRatio: 1.0,
                    rememberLastUsedCamera: true,
                    supportedScanTypes: [Html5QrcodeScanType.SCAN_TYPE_CAMERA]
                };
                
                // Get camera list and start with back camera if available
                const devices = await Html5Qrcode.getCameras();
                if (devices && devices.length > 0) {
                    // Prefer back camera
                    const backCamera = devices.find(device => 
                        device.label.toLowerCase().includes('back') || 
                        device.label.includes('2') ||
                        device.label.includes('rear')
                    );
                    
                    cameraId = backCamera ? backCamera.id : devices[0].id;
                    
                    // Start scanning
                    await html5QrCode.start(
                        cameraId,
                        config,
                        onScanSuccess,
                        onScanError
                    );
                    
                    scanStatus.textContent = "Ready to scan - Point camera at QR code";
                    scanStatus.className = 'scan-status';
                    isScanning = true;
                    
                    console.log("‚úÖ Camera started successfully");
                } else {
                    throw new Error("No cameras found");
                }
                
            } catch (error) {
                console.error("Camera error:", error);
                updateScanStatus("Camera error: " + error.message, "error");
                
                // Try fallback method
                try {
                    await html5QrCode.start(
                        { facingMode: "environment" },
                        config,
                        onScanSuccess,
                        onScanError
                    );
                    
                    updateScanStatus("Camera ready (fallback mode)", "info");
                    isScanning = true;
                } catch (fallbackError) {
                    console.error("Fallback also failed:", fallbackError);
                    updateScanStatus("Failed to access camera", "error");
                    
                    setTimeout(() => {
                        closeCameraScanner();
                        showToast("Using manual input instead", "info");
                    }, 3000);
                }
            }
        }

        // Handle successful scan
        async function onScanSuccess(decodedText, decodedResult) {
            console.log("QR Code detected:", decodedText);
            
            if (!isScanning) return;
            
            // Stop scanning temporarily
            isScanning = false;
            if (html5QrCode && html5QrCode.isScanning) {
                html5QrCode.pause();
            }
            
            updateScanStatus("‚úì QR Code detected!", "success");
            
            // Play success sound
            playBeepSound();
            
            // Process the scanned data
            await processScannedQR(decodedText);
            
            // Resume scanning after 2 seconds
            setTimeout(() => {
                if (html5QrCode && !isScanning) {
                    html5QrCode.resume();
                    isScanning = true;
                    updateScanStatus("Ready to scan", "info");
                }
            }, 2000);
        }

        // Handle scan errors
        function onScanError(error) {
            // Ignore common scanning errors during normal operation
            if (!error.includes('NotFoundException') && 
                !error.includes('No QR code found')) {
                console.debug("QR scanning:", error);
            }
        }

        // Process scanned QR code
        async function processScannedQR(qrData) {
            const salespersonName = document.getElementById('salespersonName')?.value.trim();
            
            if (!salespersonName) {
                updateScanStatus("Please enter your name first", "error");
                
                // Close camera and focus on name field
                setTimeout(() => {
                    closeCameraScanner();
                    const nameField = document.getElementById('salespersonName');
                    if (nameField) {
                        nameField.focus();
                    }
                    showToast("Please enter your name first", "error");
                }, 1000);
                return;
            }
            
            // Auto-fill the input field
            const inputField = document.getElementById('voucherCodeInput');
            if (inputField) {
                inputField.value = qrData;
            }
            
            // Process the scan
            const result = await processScanData(qrData, salespersonName);
            
            // Display results
            if (result.success) {
                updateScanStatus("‚úì Scan Successful!", "success");
                displayScanResults(result, true);
                
                // Close camera after successful scan
                setTimeout(() => {
                    closeCameraScanner();
                    showToast("Scan processed successfully!", "success");
                }, 2000);
            } else {
                updateScanStatus("‚úó " + result.message, "error");
                displayScanResults(result, false);
                
                // Resume scanning after 3 seconds
                setTimeout(() => {
                    if (html5QrCode && !isScanning) {
                        html5QrCode.resume();
                        isScanning = true;
                        updateScanStatus("Ready to scan", "info");
                    }
                }, 3000);
            }
        }

        // Play beep sound
        function playBeepSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                // Sound not critical
            }
        }

        // Switch camera
        async function switchCamera() {
            if (!html5QrCode || !isScanning) return;
            
            updateScanStatus("Switching camera...", "info");
            
            try {
                // Get available cameras
                const devices = await Html5Qrcode.getCameras();
                if (devices.length < 2) {
                    showToast("Only one camera available", "info");
                    return;
                }
                
                // Stop current camera
                await html5QrCode.stop();
                isScanning = false;
                
                // Find next camera
                const currentIndex = devices.findIndex(device => device.id === cameraId);
                const nextIndex = (currentIndex + 1) % devices.length;
                cameraId = devices[nextIndex].id;
                
                // Restart with new camera
                const config = {
                    fps: 10,
                    qrbox: { width: 250, height: 250 },
                    aspectRatio: 1.0
                };
                
                await html5QrCode.start(
                    cameraId,
                    config,
                    onScanSuccess,
                    onScanError
                );
                
                isScanning = true;
                updateScanStatus("Camera switched", "info");
                
            } catch (error) {
                console.error("Switch camera error:", error);
                updateScanStatus("Failed to switch camera", "error");
            }
        }

        // Toggle flash (simplified version)
        function toggleFlash() {
            showToast("Flash toggle not available in browser", "info");
        }

        // Close camera scanner
        async function closeCameraScanner() {
            console.log("Closing camera scanner...");
            
            const modal = document.getElementById('cameraScannerModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
            
            // Stop scanner if running
            if (html5QrCode && isScanning) {
                try {
                    await html5QrCode.stop();
                    html5QrCode.clear();
                    html5QrCode = null;
                } catch (error) {
                    console.error("Error stopping scanner:", error);
                }
            }
            
            isScanning = false;
            resetScanStatus();
        }

        // Update scan status
        function updateScanStatus(message, type) {
            const statusElement = document.getElementById('scanStatus');
            if (!statusElement) return;
            
            statusElement.textContent = message;
            statusElement.classList.remove('scan-success', 'scan-error', 'scan-processing');
            
            if (type === 'success') {
                statusElement.classList.add('scan-success');
            } else if (type === 'error') {
                statusElement.classList.add('scan-error');
            } else if (type === 'processing') {
                statusElement.classList.add('scan-processing');
            }
        }

        // Reset scan status
        function resetScanStatus() {
            updateScanStatus("Point camera at QR code", "info");
        }

        // Display scan results
        function displayScanResults(result, success) {
            const resultsDiv = document.getElementById('scanResults');
            if (!resultsDiv) return;
            
            resultsDiv.classList.remove('hidden');
            
            if (success) {
                resultsDiv.className = 'scan-results success';
                
                let detailsHtml = '';
                if (result.type === 'voucher') {
                    const voucher = result.data;
                    detailsHtml = `
                        <h4>‚úÖ Voucher Redeemed Successfully!</h4>
                        <div class="details-grid">
                            <div class="detail-item">
                                <strong>Voucher Code</strong>
                                <div>${voucher.code}</div>
                            </div>
                            <div class="detail-item">
                                <strong>Member</strong>
                                <div>${voucher.memberName} (${voucher.memberJCId})</div>
                            </div>
                            <div class="detail-item">
                                <strong>Discount</strong>
                                <div>${voucher.discountPercentage}% off</div>
                            </div>
                            <div class="detail-item">
                                <strong>Status</strong>
                                <div style="color: #28a745; font-weight: bold;">REDEEMED</div>
                            </div>
                            <div class="detail-item">
                                <strong>Redeemed By</strong>
                                <div>${voucher.redeemedBy}</div>
                            </div>
                            <div class="detail-item">
                                <strong>Date</strong>
                                <div>${new Date(voucher.usedDate).toLocaleString()}</div>
                            </div>
                        </div>
                    `;
                } else if (result.type === 'redemption') {
                    const redemption = result.data;
                    detailsHtml = `
                        <h4>‚úÖ QR Redemption Successful!</h4>
                        <div class="details-grid">
                            <div class="detail-item">
                                <strong>Redemption ID</strong>
                                <div>${redemption.redemptionId}</div>
                            </div>
                            <div class="detail-item">
                                <strong>Member</strong>
                                <div>${redemption.memberName} (${redemption.memberJCId})</div>
                            </div>
                            <div class="detail-item">
                                <strong>Purchase Amount</strong>
                                <div>${redemption.purchaseAmount.toLocaleString()} UGX</div>
                            </div>
                            <div class="detail-item">
                                <strong>Redemption Type</strong>
                                <div>${redemption.selectedOption.type === 'points_redemption' ? 'Pay with Points' : 'Discount Voucher'}</div>
                            </div>
                            <div class="detail-item">
                                <strong>Status</strong>
                                <div style="color: #28a745; font-weight: bold;">COMPLETED</div>
                            </div>
                            <div class="detail-item">
                                <strong>Redeemed By</strong>
                                <div>${redemption.redeemedBy}</div>
                            </div>
                            <div class="detail-item">
                                <strong>Date</strong>
                                <div>${new Date(redemption.redeemedDate).toLocaleString()}</div>
                            </div>
                        </div>
                    `;
                } else if (result.type === 'member') {
                    const member = result.data;
                    detailsHtml = `
                        <h4>‚úÖ Member Found!</h4>
                        <div class="details-grid">
                            <div class="detail-item">
                                <strong>JC ID</strong>
                                <div>${member.jcId}</div>
                            </div>
                            <div class="detail-item">
                                <strong>Name</strong>
                                <div>${member.name}</div>
                            </div>
                            <div class="detail-item">
                                <strong>Tier</strong>
                                <div>${member.tier}</div>
                            </div>
                            <div class="detail-item">
                                <strong>Points</strong>
                                <div>${member.points?.toLocaleString() || 0}</div>
                            </div>
                            <div class="detail-item">
                                <strong>Total Spent</strong>
                                <div>${(member.totalSpent || 0).toLocaleString()} UGX</div>
                            </div>
                        </div>
                    `;
                }
                
                resultsDiv.innerHTML = detailsHtml;
            } else {
                resultsDiv.className = 'scan-results error';
                resultsDiv.innerHTML = `
                    <h4>‚ùå Scan Failed</h4>
                    <p><strong>Error:</strong> ${result.message}</p>
                    <p>Please try again or enter the code manually.</p>
                `;
            }
        }

        // Process scan manually
        async function processScan() {
            const qrData = document.getElementById('voucherCodeInput').value.trim();
            const salespersonName = document.getElementById('salespersonName').value.trim();
            
            if (!qrData) {
                showToast("Please enter a voucher code or QR data", "error");
                return;
            }
            
            if (!salespersonName) {
                showToast("Please enter your name", "error");
                return;
            }
            
            showToast("Processing scan...", "info");
            
            const result = await processScanData(qrData, salespersonName);
            
            if (result.success) {
                showToast(result.message, "success");
                displayScanResults(result, true);
            } else {
                showToast(result.message, "error");
                displayScanResults(result, false);
            }
        }

        // Process scan data
        async function processScanData(qrData, salespersonName) {
            try {
                console.log("Processing scan data:", qrData.substring(0, 50) + "...");
                
                // Try voucher first
                const voucherResult = voucherSystem.redeemVoucher(qrData, salespersonName);
                if (voucherResult.success) {
                    return {
                        success: true,
                        type: 'voucher',
                        message: voucherResult.message,
                        data: voucherResult.voucher
                    };
                }
                
                // Try QR redemption
                const redemptionResult = qrRedemptionSystem.processRedemption(qrData, salespersonName);
                if (redemptionResult.success) {
                    return {
                        success: true,
                        type: 'redemption',
                        message: redemptionResult.message,
                        data: redemptionResult.redemption
                    };
                }
                
                // Check if it's a JC ID
                if (qrData.startsWith('JC')) {
                    const member = await clubManager.db.getMemberByJCId(qrData);
                    if (member) {
                        return {
                            success: true,
                            type: 'member',
                            message: `Member found: ${member.name}`,
                            data: member
                        };
                    }
                }
                
                // Try to parse as JSON
                try {
                    const parsedData = JSON.parse(qrData);
                    if (parsedData && parsedData.code) {
                        const voucherResult2 = voucherSystem.redeemVoucher(parsedData.code, salespersonName);
                        if (voucherResult2.success) {
                            return {
                                success: true,
                                type: 'voucher',
                                message: voucherResult2.message,
                                data: voucherResult2.voucher
                            };
                        }
                    }
                } catch (e) {
                    // Not JSON
                }
                
                return {
                    success: false,
                    message: "Invalid QR code. Please scan a valid Jeans Club voucher or redemption QR code."
                };
                
            } catch (error) {
                console.error("Scan processing error:", error);
                return {
                    success: false,
                    message: "Error processing QR code: " + error.message
                };
            }
        }

        // ===========================
        // VOUCHER SYSTEM
        // ===========================
        class VoucherSystem {
            constructor() {
                this.vouchers = JSON.parse(localStorage.getItem('jeansClubVouchers') || '[]');
            }

            generateVoucherCode() {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                let code = '';
                for (let i = 0; i < 8; i++) {
                    code += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return 'JC' + code;
            }

            createVoucher(memberJCId, memberName, pointsUsed, discountPercentage, expiryDays = 30) {
                const voucherCode = this.generateVoucherCode();
                const createdDate = new Date();
                const expiryDate = new Date();
                expiryDate.setDate(expiryDate.getDate() + expiryDays);

                const voucher = {
                    id: 'voucher_' + Date.now(),
                    code: voucherCode,
                    memberJCId: memberJCId,
                    memberName: memberName,
                    pointsUsed: pointsUsed,
                    discountPercentage: discountPercentage,
                    createdDate: createdDate.toISOString(),
                    expiryDate: expiryDate.toISOString(),
                    status: 'active',
                    usedDate: null
                };

                this.vouchers.push(voucher);
                this.saveVouchers();

                return voucher;
            }

            getVoucherByCode(code) {
                return this.vouchers.find(v => v.code === code);
            }

            redeemVoucher(voucherCode, redeemedBy = 'system') {
                const voucher = this.getVoucherByCode(voucherCode);
                if (!voucher) {
                    return { success: false, message: "Voucher not found" };
                }

                if (voucher.status === 'used') {
                    return { success: false, message: "Voucher has already been used" };
                }

                if (voucher.status === 'expired') {
                    return { success: false, message: "Voucher has expired" };
                }

                if (new Date() > new Date(voucher.expiryDate)) {
                    voucher.status = 'expired';
                    this.saveVouchers();
                    return { success: false, message: "Voucher has expired" };
                }

                voucher.status = 'used';
                voucher.usedDate = new Date().toISOString();
                voucher.redeemedBy = redeemedBy;
                this.saveVouchers();

                return { 
                    success: true, 
                    message: `Voucher redeemed successfully! ${voucher.discountPercentage}% discount applied.`,
                    voucher: voucher
                };
            }

            getMemberVouchers(memberJCId) {
                return this.vouchers.filter(v => v.memberJCId === memberJCId)
                    .sort((a, b) => new Date(b.createdDate) - new Date(a.createdDate));
            }

            getAllVouchers() {
                return this.vouchers.sort((a, b) => new Date(b.createdDate) - new Date(a.createdDate));
            }

            saveVouchers() {
                localStorage.setItem('jeansClubVouchers', JSON.stringify(this.vouchers));
            }
        }

        // ===========================
        // INITIALIZE SYSTEMS
        // ===========================
        const voucherSystem = new VoucherSystem();
        
        // Initialize Supabase DB
        const { createClient } = supabase;
        class SupabaseDB {
            constructor() {
                this.supabaseUrl = 'https://uoyzsyxjrfygrsfzhlao.supabase.co';
                this.anonKey = 'sb_publishable__gS2-Pd9S7I5dBlq4rmzMQ_K2QMwovA';
                this.supabase = createClient(this.supabaseUrl, this.anonKey);
            }

            async getMemberByJCId(jcId) {
                try {
                    const { data: member, error } = await this.supabase
                        .from('members')
                        .select('*')
                        .eq('jcId', jcId)
                        .single();
                    return member || null;
                } catch (error) {
                    console.error('Error fetching member:', error);
                    return null;
                }
            }
        }

        // Initialize Jeans Club Manager
        class JeansClubManager {
            constructor() {
                this.db = new SupabaseDB();
                this.currentMember = null;
                this.isAdmin = false;
            }
        }

        const clubManager = new JeansClubManager();

        // Initialize QR Redemption System
        class QRRedemptionSystem {
            constructor() {
                this.redemptions = JSON.parse(localStorage.getItem('jeansClubRedemptions') || '[]');
            }

            processRedemption(qrData, salespersonName) {
                // Simple implementation - just check for redemption ID
                const redemption = this.redemptions.find(r => r.redemptionId === qrData);
                if (redemption) {
                    if (redemption.status === 'completed') {
                        return { success: false, message: "Redemption has already been completed" };
                    }
                    
                    redemption.status = 'completed';
                    redemption.redeemedBy = salespersonName;
                    redemption.redeemedDate = new Date().toISOString();
                    localStorage.setItem('jeansClubRedemptions', JSON.stringify(this.redemptions));
                    
                    return {
                        success: true,
                        message: `Redemption completed successfully by ${salespersonName}`,
                        redemption: redemption
                    };
                }
                return { success: false, message: "Redemption not found" };
            }
        }

        const qrRedemptionSystem = new QRRedemptionSystem();

        // ===========================
        // UI FUNCTIONS
        // ===========================
        function showToast(message, type = "info") {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};
                color: white;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                animation: slideIn 0.3s ease;
                max-width: 400px;
                word-wrap: break-word;
            `;
            
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function hideAllSections() {
            const sections = document.querySelectorAll('.card:not(.qr-share-section)');
            sections.forEach(section => section.classList.add('hidden'));
            
            const infoPages = document.querySelectorAll('.info-page');
            infoPages.forEach(page => page.classList.add('hidden'));
        }

        function showSignupScreen() {
            hideAllSections();
            document.getElementById('signupSection').classList.remove('hidden');
        }

        function showLoginScreen() {
            hideAllSections();
            document.getElementById('loginSection').classList.remove('hidden');
        }

        function showAdminPanel() {
            hideAllSections();
            document.getElementById('adminSection').classList.remove('hidden');
        }

        function showQRRedemptionPanel() {
            hideAllSections();
            // Show QR redemption section if exists
            const qrSection = document.getElementById('qrRedemptionSection');
            if (qrSection) qrSection.classList.remove('hidden');
        }

        // Search functionality
        function showSearch() {
            const modal = document.getElementById('searchModal');
            modal.classList.add('active');
            document.getElementById('searchInput').focus();
        }

        function hideSearch() {
            const modal = document.getElementById('searchModal');
            modal.classList.remove('active');
            document.getElementById('searchInput').value = '';
            document.getElementById('searchResults').innerHTML = '';
        }

        // Mobile menu
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }

        function toggleUserMenu() {
            if (clubManager.currentMember) {
                showDashboard(clubManager.currentMember);
            } else {
                showLoginScreen();
            }
        }

        // Initialize on load
        window.onload = function() {
            showSignupScreen();
            
            // Add CSS for toast animations
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        };

        // Add event listeners for closing modals
        document.addEventListener('click', function(event) {
            const navLinks = document.getElementById('navLinks');
            const menuToggle = document.querySelector('.menu-toggle');
            
            if (!menuToggle.contains(event.target) && !navLinks.contains(event.target)) {
                navLinks.classList.remove('active');
            }
            
            // Close search modal
            const searchModal = document.getElementById('searchModal');
            if (searchModal.classList.contains('active') && 
                !searchModal.contains(event.target) && 
                event.target !== document.querySelector('.search-icon')) {
                hideSearch();
            }
        });

        // Close with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const searchModal = document.getElementById('searchModal');
                if (searchModal.classList.contains('active')) {
                    hideSearch();
                }
                
                const cameraModal = document.getElementById('cameraScannerModal');
                if (cameraModal.classList.contains('active')) {
                    closeCameraScanner();
                }
            }
        });

        // Export for debugging
        window.openCameraScanner = openCameraScanner;
        window.closeCameraScanner = closeCameraScanner;
        window.processScan = processScan;
    </script>
</body>
</html>